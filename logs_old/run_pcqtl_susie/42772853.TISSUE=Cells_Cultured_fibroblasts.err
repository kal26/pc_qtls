Building DAG of jobs...
Using shell: /home/klawren/micromamba/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=30000, mem_mib=954, disk_mb=1000, disk_mib=954, nodes=1, threads=1
Select jobs to execute...

[Thu Mar 21 10:34:03 2024]
rule run_pcqtl_susie:
    input: data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01.fam, output/pcs_proteincoding/Cells_Cultured_fibroblasts.pcs.bed, data/processed/covariates_tami/Cells_Cultured_fibroblasts.v8.covariates.txt
    output: output/pcqtl_proteincoding/Cells_Cultured_fibroblasts/Cells_Cultured_fibroblasts.v8.pcs.susie.txt
    jobid: 0
    reason: Missing output files: output/pcqtl_proteincoding/Cells_Cultured_fibroblasts/Cells_Cultured_fibroblasts.v8.pcs.susie.txt
    wildcards: TISSUE=Cells_Cultured_fibroblasts
    resources: mem_mb=30000, mem_mib=954, disk_mb=1000, disk_mib=954, tmpdir=/local/scratch/klawren/slrmtmp.42772853, partition=batch, account=smontgom, time=2:00:00, mem=30G, nodes=1, threads=1


        python workflow/scripts/run_susie.py data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01             output/pcs_proteincoding/Cells_Cultured_fibroblasts.pcs.bed             output/pcqtl_proteincoding/Cells_Cultured_fibroblasts/Cells_Cultured_fibroblasts.v8.pcs.susie.txt             data/processed/covariates_tami/Cells_Cultured_fibroblasts.v8.covariates.txt
        
Activating conda environment: tensorqtl_r
Warning: The R output will not be colorized because it seems that your terminal does not support ANSI escape codes. isatty(stdout()) returned FALSE.

Mapping files:   0%|          | 0/3 [00:00<?, ?it/s]Mapping files:  33%|███▎      | 1/3 [00:10<00:20, 10.01s/it]Mapping files:  67%|██████▋   | 2/3 [00:10<00:04,  4.56s/it]Mapping files: 100%|██████████| 3/3 [00:13<00:00,  3.76s/it]Mapping files: 100%|██████████| 3/3 [00:13<00:00,  4.52s/it]
Traceback (most recent call last):
  File "workflow/scripts/run_susie.py", line 41, in <module>
    main()
  File "workflow/scripts/run_susie.py", line 32, in main
    susie_df = susie.map(genotype_df, variant_df, 
  File "/home/klawren/micromamba/envs/tensorqtl_r/lib/python3.8/site-packages/tensorqtl/susie.py", line 705, in map
    res = susie(genotypes_res_t.T, phenotype_res_t.T, L=L,
  File "/home/klawren/micromamba/envs/tensorqtl_r/lib/python3.8/site-packages/tensorqtl/susie.py", line 495, in susie
    s = init_finalize(s)
  File "/home/klawren/micromamba/envs/tensorqtl_r/lib/python3.8/site-packages/tensorqtl/susie.py", line 99, in init_finalize
    raise ValueError("prior variance must be non-negative")
ValueError: prior variance must be non-negative
[Thu Mar 21 10:53:04 2024]
Error in rule run_pcqtl_susie:
    jobid: 0
    input: data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01.fam, output/pcs_proteincoding/Cells_Cultured_fibroblasts.pcs.bed, data/processed/covariates_tami/Cells_Cultured_fibroblasts.v8.covariates.txt
    output: output/pcqtl_proteincoding/Cells_Cultured_fibroblasts/Cells_Cultured_fibroblasts.v8.pcs.susie.txt
    conda-env: tensorqtl_r
    shell:
        
        python workflow/scripts/run_susie.py data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01             output/pcs_proteincoding/Cells_Cultured_fibroblasts.pcs.bed             output/pcqtl_proteincoding/Cells_Cultured_fibroblasts/Cells_Cultured_fibroblasts.v8.pcs.susie.txt             data/processed/covariates_tami/Cells_Cultured_fibroblasts.v8.covariates.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
