Building DAG of jobs...
Using shell: /home/klawren/micromamba/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=30000, mem_mib=954, disk_mb=1000, disk_mib=954, nodes=1, threads=1
Select jobs to execute...

[Fri Mar 22 13:35:46 2024]
rule run_pcqtl_susie:
    input: data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01.fam, output/pcs_proteincoding/Artery_Tibial.pcs.bed, data/processed/covariates_tami/Artery_Tibial.v8.covariates.txt
    output: output/pcqtl_proteincoding/Artery_Tibial/Artery_Tibial.v8.pcs.susie.txt
    jobid: 0
    reason: Missing output files: output/pcqtl_proteincoding/Artery_Tibial/Artery_Tibial.v8.pcs.susie.txt
    wildcards: TISSUE=Artery_Tibial
    resources: mem_mb=30000, mem_mib=954, disk_mb=1000, disk_mib=954, tmpdir=/local/scratch/klawren/slrmtmp.42774716, partition=batch, account=smontgom, time=2:00:00, mem=30G, nodes=1, threads=1


        python workflow/scripts/run_susie.py data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01             output/pcs_proteincoding/Artery_Tibial.pcs.bed             output/pcqtl_proteincoding/Artery_Tibial/Artery_Tibial.v8.pcs.susie.txt             data/processed/covariates_tami/Artery_Tibial.v8.covariates.txt
        
Activating conda environment: tensorqtl_r
Warning: The R output will not be colorized because it seems that your terminal does not support ANSI escape codes. isatty(stdout()) returned FALSE.

Traceback (most recent call last):
  File "workflow/scripts/run_susie.py", line 41, in <module>
    main()
  File "workflow/scripts/run_susie.py", line 23, in main
    phenotype_df, phenotype_pos_df = tensorqtl.read_phenotype_bed(args.phenotype_path)
  File "/home/klawren/micromamba/envs/tensorqtl_r/lib/python3.8/site-packages/tensorqtl/core.py", line 387, in read_phenotype_bed
    assert pos_df.equals(
AssertionError: Positions in BED file must be sorted.
[Fri Mar 22 13:35:57 2024]
Error in rule run_pcqtl_susie:
    jobid: 0
    input: data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01.fam, output/pcs_proteincoding/Artery_Tibial.pcs.bed, data/processed/covariates_tami/Artery_Tibial.v8.covariates.txt
    output: output/pcqtl_proteincoding/Artery_Tibial/Artery_Tibial.v8.pcs.susie.txt
    conda-env: tensorqtl_r
    shell:
        
        python workflow/scripts/run_susie.py data/processed/genotypes/GTEx_Analysis_2017-06-05_v8_WholeGenomeSeq_838Indiv_Analysis_Freeze.SHAPEIT2_phased.MAF01             output/pcs_proteincoding/Artery_Tibial.pcs.bed             output/pcqtl_proteincoding/Artery_Tibial/Artery_Tibial.v8.pcs.susie.txt             data/processed/covariates_tami/Artery_Tibial.v8.covariates.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
